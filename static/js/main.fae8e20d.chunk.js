(this["webpackJsonpreact-router-practice"]=this["webpackJsonpreact-router-practice"]||[]).push([[0],{34:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var r,a,c,s,i,o,u,l,b,j,p,d,h,x=n(1),O=n.n(x),f=n(24),g=n.n(f),v=(n(34),n(6)),m=n(12),k=n(3),y=n(4),w=n(5),S=n(0),C=w.a.div(r||(r=Object(y.a)(["\n  max-width: 800px;\n  min-height: 600px;\n  margin: 20px auto;\n  border: 1px solid #ccc;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;\n"]))),P=w.a.div(a||(a=Object(y.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  div + div {\n    margin-top: 30px;\n  }\n"]))),I=w.a.h1(c||(c=Object(y.a)(["\n  text-align: left;\n  margin-top: 0;\n"]))),_=w.a.a(s||(s=Object(y.a)(["\n  display: block;\n  text-align: center;\n  background: #ddd;\n  padding: 5px;\n  border: none;\n  margin-top: 30px;\n  transition: all 0.3s;\n  font-size: 16px;\n  :hover {\n    cursor: pointer;\n    background: white;\n  }\n"]))),L=function(e){var t=e.input,n=e.handleInputChange,r=!1;return"Password"===t.label&&(r=!0),Object(S.jsxs)("div",{children:[Object(S.jsxs)("div",{children:[t.label,":"]}),Object(S.jsx)("input",{placeholder:"\u60a8\u7684 ".concat(t.label),name:t.label,value:t.value,onChange:n,type:!0===r?"password":void 0})]})},E=w.a.div(i||(i=Object(y.a)(["\n  max-width: 60%;\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: flex-start;\n  div + div {\n    margin-top: 30px;\n  }\n"]))),N=w.a.h2(o||(o=Object(y.a)(["\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n"]))),A=w.a.div(u||(u=Object(y.a)(["\n  color: red;\n  margin-top: 20px;\n"]))),B=w.a.div(l||(l=Object(y.a)(["\n  display: flex;\n  width: 100%;\n  align-items: center;\n"]))),T=w.a.p(b||(b=Object(y.a)(["\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  line-height: 30px;\n"]))),J=function(e){var t=e.post,n=new Date(t.createdAt).toLocaleString();return Object(S.jsxs)("div",{style:{paddingBottom:"20px",borderBottom:"1px solid #ccc",width:"60%"},children:[Object(S.jsx)(N,{children:t.title}),Object(S.jsx)("div",{children:n}),Object(S.jsx)(T,{children:t.body}),Object(S.jsx)(m.b,{to:"/posts/".concat(t.id),style:{cursor:"pointer",color:"black"},children:"\u7e7c\u7e8c\u95b1\u8b80"})]})},z=function(e){var t=e.postContent,n=e.handlePostChange,r=e.handleAddNewPost,a=e.errorMessage;return Object(S.jsxs)(C,{style:{justifyContent:"flex-start",height:"100%"},children:[Object(S.jsx)(I,{style:{marginTop:"30px"},children:"\u65b0\u589e\u6587\u7ae0"}),Object(S.jsxs)(P,{style:{width:"90%",height:"100%",justifyContent:"center"},children:[Object(S.jsxs)(B,{children:[Object(S.jsx)("h3",{children:"\u6587\u7ae0\u6a19\u984c\uff1a"}),Object(S.jsx)("input",{style:{height:"29px"},placeholder:"\u6a19\u984c",value:t.title,onChange:function(e){n(e,"title")}})]}),Object(S.jsx)(I,{as:"h3",children:"\u6587\u7ae0\u5167\u5bb9"}),Object(S.jsx)("textarea",{value:t.content,style:{margin:"0 auto",height:"230px",width:"80%"},onChange:function(e){n(e,"content")}}),Object(S.jsx)("div",{style:{display:"visibility",margin:"10px auto",color:"red"},children:a}),Object(S.jsx)(_,{style:{margin:"30px auto",padding:"10px",width:"70px",borderRadius:"3px"},onClick:r,children:"\u65b0\u589e"})]})]})},F=w.a.div(j||(j=Object(y.a)(["\n  display: flex;\n  flex-direction: column;\n  margin: 0 auto;\n  margin-top: 80px;\n"]))),M=w.a.div(p||(p=Object(y.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-bottom: 35px;\n  div + div {\n    margin-left: 20px;\n  }\n  a + a {\n    margin-left: 20px;\n  }\n"]))),D=w.a.div(d||(d=Object(y.a)(["\n  border-radius: 50%;\n  height: 30px;\n  width: 30px;\n  margin: 0 20px;\n  text-align: center;\n  line-height: 30px;\n  background-color: #ddd;\n  color: black;\n"]))),R=Object(w.a)(m.b)(h||(h=Object(y.a)(["\n  color: black;\n  text-decoration: none;\n  :hover {\n    text-decoration: underline;\n  }\n"]))),U=function(e){var t=e.currentPage,n=e.totalPostCount,r=e.handleClickPage,a=Math.floor(n/5);return n%5!==0&&(a+=1),Object(S.jsxs)(F,{children:[Object(S.jsxs)(M,{children:[1===t?"":Object(S.jsx)(R,{onClick:r,to:"/all-post/".concat(t-1),children:"\u4e0a\u4e00\u9801"}),t-2>=1?Object(S.jsx)(R,{onClick:r,to:"/all-post/".concat(t-2),children:t-2}):"",t-1>=1?Object(S.jsx)(R,{onClick:r,to:"/all-post/".concat(t-1),children:t-1}):"",Object(S.jsx)(D,{children:t}),a-t>=1?Object(S.jsx)(R,{onClick:r,to:"/all-post/".concat(t+1),children:t+1}):"",a-t>=2?Object(S.jsx)(R,{onClick:r,to:"/all-post/".concat(t+2),children:t+2}):"",a-t>=1?Object(S.jsx)(R,{onClick:r,to:"/all-post/".concat(t+1),children:"\u4e0b\u4e00\u9801"}):""]}),Object(S.jsxs)(M,{children:[1!==t?Object(S.jsx)(R,{onClick:r,to:"/all-post/1",children:"\u7b2c\u4e00\u9801"}):"",t!==a?Object(S.jsx)(R,{onClick:r,to:"/all-post/".concat(a),children:"\u6700\u5f8c\u4e00\u9801"}):""]})]})};function H(){return Object(S.jsxs)(E,{children:[Object(S.jsx)("h1",{children:"\u54c8\u56c9\uff5e\u4f60\u4f86\u5230\u9996\u9801"}),Object(S.jsx)("p",{children:"\u9019\u88e1\u662f\u9996\u9801\uff0c\u4f46\u6211\u4e0d\u77e5\u9053\u653e\u4ec0\u9ebc\u3002\u8981\u770b\u6587\u7ae0\u8acb\u53bb\u6240\u6709\u6587\u7ae0\uff5e"})]})}function q(){return Object(S.jsxs)(E,{children:[Object(S.jsx)("h1",{children:"\u95dc\u65bc\u6211"}),Object(S.jsx)("p",{children:"\u5982\u6709\u96f7\u540c\uff0c\u7d14\u5c6c\u6284\u8972\u3002"})]})}var G=n(2),K=n.n(G),Q=n(8),V=n(19),W="https://student-json-api.lidemy.me";function X(e,t,n){return Y.apply(this,arguments)}function Y(){return(Y=Object(Q.a)(K.a.mark((function e(t,n,r){var a,c;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(W,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:t,username:n,password:r})});case 3:return a=e.sent,e.next=6,a.json();case 6:c=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",{ok:0,message:e.t0.toString()});case 12:if(0===Object.keys(c).length){e.next=14;break}return e.abrupt("return",c);case 14:if(!a.ok){e.next=18;break}return e.abrupt("return",c);case 18:return e.abrupt("return",{ok:0,message:a.status});case 19:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function Z(e,t){return $.apply(this,arguments)}function $(){return($=Object(Q.a)(K.a.mark((function e(t,n){var r,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(W,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:n})});case 3:return r=e.sent,e.next=6,r.json();case 6:a=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",{ok:0,message:e.t0.toString()});case 12:if(0===Object.keys(a).length){e.next=14;break}return e.abrupt("return",a);case 14:if(!r.ok){e.next=18;break}return e.abrupt("return",r.json());case 18:return e.abrupt("return",{ok:0,message:r.status});case 19:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function ee(){return te.apply(this,arguments)}function te(){return(te=Object(Q.a)(K.a.mark((function e(){var t,n,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("user_token"),e.prev=1,e.next=4,fetch("".concat(W,"/me"),{headers:{authorization:"Bearer ".concat(t)}});case 4:n=e.sent,r=n.json(),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{ok:0,message:e.t0.toString()});case 11:if(0===Object.keys(r).length){e.next=13;break}return e.abrupt("return",r);case 13:if(!n.ok){e.next=17;break}return e.abrupt("return",r);case 17:return e.abrupt("return",{ok:0,message:n.status});case 18:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function ne(){return(ne=Object(Q.a)(K.a.mark((function e(t,n){var r,a,c;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=localStorage.getItem("user_token"),e.prev=1,e.next=4,fetch("".concat(W,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(r),"content-type":"application/json"},body:JSON.stringify({title:t,body:n})});case 4:a=e.sent,c=a.json(),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",{ok:0,message:e.t0.toString()});case 11:if(0===Object.keys(c).length){e.next=13;break}return e.abrupt("return",c);case 13:if(!a.ok){e.next=17;break}return e.abrupt("return",c);case 17:return e.abrupt("return",{ok:0,message:a.status});case 18:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function re(e){return ae.apply(this,arguments)}function ae(){return(ae=Object(Q.a)(K.a.mark((function e(t){var n,r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(W,"/posts?id=").concat(t));case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",{ok:0,message:e.t0.toString()});case 12:if(0===Object.keys(r).length){e.next=14;break}return e.abrupt("return",r);case 14:if(!n.ok){e.next=18;break}return e.abrupt("return",r);case 18:return e.abrupt("return",{ok:0,message:n.status});case 19:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function ce(e){return se.apply(this,arguments)}function se(){return(se=Object(Q.a)(K.a.mark((function e(t){var n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(W,"/posts?_page=").concat(t,"&_sort=createdAt&_order=desc&_limit=5"));case 3:n=e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",{ok:0,message:e.t0.toString()});case 9:if(!n.ok){e.next=13;break}return e.abrupt("return",n);case 13:return e.abrupt("return",{ok:0,message:n.status});case 14:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}var ie=Object(x.createContext)(null);function oe(){var e=Object(x.useState)(""),t=Object(v.a)(e,2),n=t[0],r=t[1],a=!1,c=Object(k.f)(),s=Object(x.useContext)(ie).setIsLogin,i=Object(x.useState)([{label:"Username",value:""},{label:"Password",value:""}]),o=Object(v.a)(i,2),u=o[0],l=o[1],b=function(e){var t=Object(V.a)(u);t.forEach((function(t){t.label===e.target.name&&(t.value=e.target.value)})),l(t)};function j(){return(j=Object(Q.a)(K.a.mark((function e(){var t,n,i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=2;break}return e.abrupt("return");case 2:return a=!0,t=u[0].value,n=u[1].value,e.next=7,Z(t,n);case 7:(i=e.sent).ok?(localStorage.setItem("user_token",i.token),s(!0),c.push("/")):r(i.message),a=!1;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(S.jsxs)(C,{children:[Object(S.jsxs)(P,{children:[Object(S.jsx)(I,{children:"\u767b\u5165"}),u.map((function(e,t){return Object(S.jsx)(L,{input:e,handleInputChange:b},t)})),Object(S.jsx)(_,{onClick:function(){return j.apply(this,arguments)},children:"\u63d0\u4ea4"})]}),Object(S.jsx)(A,{children:n})]})}function ue(){var e=Object(x.useState)(""),t=Object(v.a)(e,2),n=t[0],r=t[1],a=!1,c=Object(k.f)(),s=Object(x.useState)([{label:"Nickname",value:""},{label:"Username",value:""},{label:"Password",value:""}]),i=Object(v.a)(s,2),o=i[0],u=i[1],l=function(e){var t=Object(V.a)(o);t.forEach((function(t){t.label===e.target.name&&(t.value=e.target.value)})),u(t)};function b(){return(b=Object(Q.a)(K.a.mark((function e(){var t,n,s,i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=2;break}return e.abrupt("return");case 2:return a=!0,t=o[0].value,n=o[1].value,s=o[2].value,e.next=8,X(t,n,s);case 8:(i=e.sent).ok?(r(""),c.push("/login")):r(i.message),a=!1;case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(S.jsxs)(C,{children:[Object(S.jsxs)(P,{children:[Object(S.jsx)(I,{children:"\u8a3b\u518a"}),o.map((function(e,t){return Object(S.jsx)(L,{input:e,handleInputChange:l},t)})),Object(S.jsx)(_,{onClick:function(){return b.apply(this,arguments)},children:"\u63d0\u4ea4"})]}),Object(S.jsx)(A,{children:n})]})}n(43);var le,be,je,pe,de,he=w.a.div(le||(le=Object(y.a)(["\n  width: 100%;\n  height: 55px;\n  border-bottom: 1px solid #dbdbdb;\n"]))),xe=w.a.div(be||(be=Object(y.a)(["\n  max-width: 1200px;\n  height: 100%;\n  margin: 0 auto;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n"]))),Oe=w.a.div(je||(je=Object(y.a)(["\n  display: flex;\n  width: 100%;\n  height: 100%;\n  justify-content: center;\n  align-items: center;\n  a + a {\n    margin-left: 30px;\n  }\n  div + a {\n    margin-left: 30px;\n  }\n"]))),fe=w.a.div(pe||(pe=Object(y.a)(["\n  font-weight: 600;\n  font-size: 24px;\n"]))),ge=Object(w.a)(m.b)(de||(de=Object(y.a)(["\n  display: block;\n  height: 100%;\n  line-height: 54px;\n  text-decoration: none;\n  padding: 0 10px;\n  color: black;\n  background-color: ",";\n  :hover {\n    cursor: pointer;\n  }\n"])),(function(e){return e.active?"#ccc":""}));function ve(e){var t=e.label,n=e.to,r=e.exact,a=Object(k.h)({path:n,exact:r});return Object(S.jsx)(ge,{to:n,label:t,active:a&&"true",children:t})}function me(){var e=Object(x.useContext)(ie),t=e.isLogin,n=e.setIsLogin,r=Object(k.f)();return Object(x.useEffect)((function(){function e(){return(e=Object(Q.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee();case 2:if(!e.sent.ok){e.next=5;break}return e.abrupt("return",n(!0));case 5:n(!1),localStorage.setItem("user_token","");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}localStorage.getItem("user_token")&&function(){e.apply(this,arguments)}()}),[n]),Object(S.jsx)(he,{children:Object(S.jsxs)(xe,{children:[Object(S.jsxs)(Oe,{children:[Object(S.jsx)(fe,{children:"\b\bRich"}),Object(S.jsx)(ve,{exact:!0,to:"/",label:"\u9996\u9801"}),Object(S.jsx)(ve,{to:"/all-post/",label:"\u6240\u6709\u6587\u7ae0"}),Object(S.jsx)(ve,{to:"/about",label:"About"})]}),Object(S.jsxs)(Oe,{children:[!t&&Object(S.jsx)(ve,{to:"/login",label:"\u767b\u5165"}),!t&&Object(S.jsx)(ve,{to:"/register",label:"\u8a3b\u518a"}),t&&Object(S.jsx)(ge,{as:"div",onClick:function(){n(!1),localStorage.setItem("user_token",""),r.push("/")},children:"\u767b\u51fa"}),t&&Object(S.jsx)(ve,{to:"/add-post",label:"\u767c\u8868\u6587\u7ae0"})]})]})})}var ke=n(29);function ye(){var e=!1,t=Object(k.f)(),n=Object(x.useState)({title:"",content:""}),r=Object(v.a)(n,2),a=r[0],c=r[1],s=Object(x.useState)(""),i=Object(v.a)(s,2),o=i[0],u=i[1];return Object(S.jsx)(z,{handlePostChange:function(e,t){var n=Object(ke.a)({},a);n[t]=e.target.value,c(n)},postContent:a,handleAddNewPost:function(){e||(e=!0,""!==a.title&&""!==a.content?function(e,t){return ne.apply(this,arguments)}(a.title,a.content).then((function(n){0!==n.ok?(e=!1,t.push("/")):u(n.message)})):u("\u6587\u7ae0\u6a19\u984c\u6216\u5167\u5bb9\u4e0d\u5f97\u70ba\u7a7a"))},errorMessage:o})}function we(){var e=Object(x.useState)(""),t=Object(v.a)(e,2),n=t[0],r=t[1],a=Object(k.g)(),c=Object(x.useState)({title:"",time:"",content:""}),s=Object(v.a)(c,2),i=s[0],o=s[1];return Object(x.useEffect)((function(){function e(){return(e=Object(Q.a)(K.a.mark((function e(){var t,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re(a.id);case 2:(t=e.sent).ok||r(t.message),t=t[0],n=new Date(t.createdAt).toLocaleString(),o({title:t.title,time:n,content:t.body});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[a.id]),Object(S.jsxs)(E,{children:[Object(S.jsx)(N,{children:i.title}),Object(S.jsx)("div",{children:i.time}),Object(S.jsx)("p",{style:{lineHeight:"30px"},children:i.content}),Object(S.jsx)(A,{children:n})]})}function Se(){var e=Object(x.useState)(""),t=Object(v.a)(e,2),n=t[0],r=t[1],a=Object(x.useState)(!0),c=Object(v.a)(a,2),s=c[0],i=c[1],o=Object(x.useState)([]),u=Object(v.a)(o,2),l=u[0],b=u[1],j=Object(k.g)().page,p=Object(x.useState)(""),d=Object(v.a)(p,2),h=d[0],O=d[1];return Object(x.useEffect)((function(){function e(){return(e=Object(Q.a)(K.a.mark((function e(){var t;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(Number(j));case 2:if((t=e.sent).ok){e.next=5;break}return e.abrupt("return",r(t.message));case 5:return O(t.headers.get("x-total-count")),e.next=8,t.json();case 8:t=e.sent,b(t),i(!1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),r("")}),[j]),Object(x.useEffect)((function(){window.scroll(0,0)}),[l]),Object(S.jsxs)(E,{children:[Object(S.jsx)(A,{children:n}),l.map((function(e,t){return Object(S.jsx)(J,{post:e},t)})),!s&&Object(S.jsx)(U,{currentPage:Number(j),totalPostCount:h,handleClickPage:function(){i(!0),b([])}})]})}function Ce(){var e=Object(x.useState)(!1),t=Object(v.a)(e,2),n=t[0],r=t[1];return Object(x.useEffect)((function(){localStorage.getItem("user_token")&&r(!0)}),[]),Object(S.jsx)(m.a,{children:Object(S.jsx)(ie.Provider,{value:{isLogin:n,setIsLogin:r},children:Object(S.jsxs)("div",{children:[Object(S.jsx)(me,{}),Object(S.jsxs)(k.c,{children:[Object(S.jsx)(k.a,{exact:!0,path:"/",children:Object(S.jsx)(H,{})}),Object(S.jsx)(k.a,{path:"/all-post/:page",children:Object(S.jsx)(Se,{})}),Object(S.jsx)(k.a,{path:"/about",children:Object(S.jsx)(q,{})}),Object(S.jsx)(k.a,{path:"/login",children:Object(S.jsx)(oe,{})}),Object(S.jsx)(k.a,{path:"/register",children:Object(S.jsx)(ue,{})}),Object(S.jsx)(k.a,{path:"/add-post",children:Object(S.jsx)(ye,{})}),Object(S.jsx)(k.a,{path:"/posts/:id",children:Object(S.jsx)(we,{})})]})]})})})}var Pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,45)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};g.a.render(Object(S.jsx)(O.a.StrictMode,{children:Object(S.jsx)(Ce,{})}),document.getElementById("root")),Pe()}},[[44,1,2]]]);
//# sourceMappingURL=main.fae8e20d.chunk.js.map